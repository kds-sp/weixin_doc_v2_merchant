<!DOCTYPE html>
    <html>
      <head>
        
        
        
        
        
        
        
        
        
        
        
        
        
        <meta />
        
    <title>退款结果通知_产品文档（V2）|微信支付商户文档中心</title><meta>
    <meta>
    
    
    
    
  
      </head>
      <body>
        
        <div><section><header><div><div><div><a><img></a></div><div><a>首页</a><a>接入指引</a><a>产品中心</a><a>解决方案</a><a>文档中心</a><a>接入微信支付</a></div><div><div> 文档中心 </div><img></div></div></div><div><img><div><a>首页</a><a>接入指引</a><a>产品中心</a><a>解决方案</a><a>文档中心</a><a>接入微信支付</a></div></div></header><section><div><div><div><div><a>产品文档（V2）</a><a>通用规则</a><a>SDK&amp;开发工具</a><a>更新日志</a></div></div><div><div><div><img><div>产品文档（V2）</div></div></div><div><button><span> 技术咨询 </span></button></div></div></div></div></section><section><aside><div><div><ul><li><section><p><span><span>支付产品</span></span><span></span></p><ul><li><section><p><span><span>付款码支付</span></span><span></span></p></section></li><li><section><p><span><span>JSAPI支付</span></span><span></span></p><ul><li><div><a><span>支付账户</span></a></div></li><li><div><a><span>场景介绍</span></a></div></li><li><div><a><span>案例介绍</span></a></div></li><li><div><a><span>接入前准备</span></a></div></li><li><div><a><span>协议规则</span></a></div></li><li><div><a><span>开发指引</span></a></div></li><li><div><a><span>获取微信版本号</span></a></div></li><li><section><p><span><span>API列表</span></span><span></span></p><ul><li><div><a><span>统一下单</span></a></div></li><li><div><a><span>JSAPI调起支付</span></a></div></li><li><div><a><span>查询订单</span></a></div></li><li><div><a><span>关闭订单</span></a></div></li><li><div><a><span>申请退款</span></a></div></li><li><div><a><span>查询退款</span></a></div></li><li><div><a><span>下载交易账单</span></a></div></li><li><div><a><span>下载资金账单</span></a></div></li><li><div><a><span>支付结果通知</span></a></div></li><li><div><a><span>交易保障</span></a></div></li><li><div><a><span>退款结果通知</span></a></div></li></ul></section></li><li><div><a><span>常见问题</span></a></div></li></ul></section></li><li><section><p><span><span>Native支付</span></span><span></span></p></section></li><li><section><p><span><span>APP支付</span></span><span></span></p></section></li><li><section><p><span><span>H5支付</span></span><span></span></p></section></li><li><section><p><span><span>小程序支付</span></span><span></span></p></section></li></ul></section></li><li><section><p><span><span>运营工具</span></span><span></span></p><ul><li><section><p><span><span>现金红包</span></span><span></span></p></section></li><li><section><p><span><span>小程序红包</span></span><span></span></p></section></li><li><section><p><span><span>付款到银行卡</span></span><span></span></p></section></li><li></li><li><section><p><span><span>委托代扣</span></span><span></span></p></section></li><li></li><li></li></ul></section></li><li><section><p><span><span>扩展工具</span></span><span></span></p><ul><li><section><p><span><span>分账</span></span><span></span></p></section></li><li><section><p><span><span>清关报关</span></span><span></span></p></section></li><li></li><li></li><li></li></ul></section></li></ul></div></div></aside><main><div><main><div><div><h1>退款结果通知</h1><span> 更新时间：2024.11.18</span><div><div><html><head></head><body><div><div><div><h2>应用场景</h2></div><div><p><span><span>当商户申请的退款有结果后（退款状态为：退款成功、退款关闭、退款异常），微信会把相关结果发送给商户，商户需要接收处理，并返回应答。</span></span><br><span><span>对后台通知交互时，如果微信收到商户的应答不是成功或超时，微信认为通知失败，微信会通过一定的策略定期重新发起通知，尽可能提高通知的成功率，但微信不保证通知最终能成功（通知频率为15s/15s/30s/3m/10m/20m/30m/30m/30m/60m/3h/3h/3h/6h/6h&nbsp;- 总计 24h4m）。 </span></span><br></p></div><table><tbody><tr><td><table><tbody><tr><td><svg><path></path></svg></td><td><div><p><span><span><span>注意</span></span></span></p></div><div><p><span><span><span>同样的通知可能会多次发送给商户系统。商户系统必须能够正确处理重复的通知。</span></span></span><br><span><span>推荐的做法是，当收到通知进行处理时，首先检查对应业务数据的状态，判断该通知是否已经处理过，如果没有处理过再进行处理，如果处理过直接返回结果成功。在对业务数据进行状态检查和处理之前，要采用数据锁进行并发控制，以避免函数重入造成的数据混乱。</span></span></p></div><div><p><span><span><span>特别说明：退款结果对重要的数据进行了加密，商户需要用商户密钥进行解密后才能获得结果通知的内容</span></span></span></p></div></td></tr></tbody></table></td></tr></tbody></table><div><h2>解密方式</h2></div><div><p><span><span>解密步骤如下：</span></span></p></div><div><p><span><span>（1）对加密串A做base64解码，得到加密串B</span></span></p></div><div><p><span><span>（2）对商户key做md5，得到32位小写key*&nbsp;( key设置路径：</span></span><span><span><a>微信商户平台</a></span></span><span><span>--&gt;账户设置--&gt;API安全--&gt;密钥设置&nbsp;)</span></span></p></div><div><p><span><span>（3）用key*对加密串B做AES-256-ECB解密（PKCS7Padding）</span></span></p></div><div><h2>接口链接</h2></div><div><p><span><span>在申请退款接口中上传参数“notify_url”以开通该功能</span></span></p></div><div><p><span><span>如果链接无法访问，商户将无法接收到微信通知。</span></span></p></div><div><p><span><span>通知url必须为直接可访问的url，不能携带参数。公网域名必须为https，如果是走专线接入，使用专线NAT&nbsp;IP或者私有回调域名可使用http。示例：notify_url：“https://pay.weixin.qq.com/wxpay/pay.action”</span></span></p></div><div><h2>通知参数</h2></div><div><table><colgroup><col><col><col><col><col><col></colgroup><tbody><tr><th><p><span><span>字段名</span></span></p></th><th><p><span><span>变量名</span></span></p></th><th><p><span><span>必填</span></span></p></th><th><p><span><span>类型</span></span></p></th><th><p><span><span>示例值</span></span></p></th><th><p><span><span>描述</span></span></p></th></tr><tr><td><p><span><span>返回状态码</span></span></p></td><td><p><span><span>return_code</span></span></p></td><td><p><span><span>是</span></span></p></td><td><p><span><span>String(16)</span></span></p></td><td><p><span><span>SUCCESS</span></span></p></td><td><p><span><span>SUCCESS/FAIL</span></span></p><p><span><span>此字段是通信标识，非交易标识，退款是否成功需要解密后查看refund_status来判断</span></span></p></td></tr><tr><td><p><span><span>返回信息</span></span></p></td><td><p><span><span>return_msg</span></span></p></td><td><p><span><span>是</span></span></p></td><td><p><span><span>String(128)</span></span></p></td><td><p><span><span>OK</span></span></p></td><td><p><span><span>当return_code为FAIL时返回信息为错误原因&nbsp;，例如</span></span></p><p><span><span>签名失败</span></span></p><p><span><span>参数格式校验错误</span></span></p></td></tr></tbody></table></div><div><p><span><span>以下字段在return_code为SUCCESS的时候有返回：</span></span></p></div><div><table><colgroup><col><col><col><col><col><col></colgroup><tbody><tr><th><p><span><span>字段名</span></span></p></th><th><p><span><span>变量名</span></span></p></th><th><p><span><span>必填</span></span></p></th><th><p><span><span>类型</span></span></p></th><th><p><span><span>示例值</span></span></p></th><th><p><span><span>描述</span></span></p></th></tr><tr><td><p><span><span>公众账号ID</span></span></p></td><td><p><span><span>appid</span></span></p></td><td><p><span><span>是</span></span></p></td><td><p><span><span>String(32)</span></span></p></td><td><p><span><span>wx8888888888888888</span></span></p></td><td><p><span><span>微信分配的公众账号ID（企业号corpid即为此appId）</span></span></p></td></tr><tr><td><p><span><span>退款的商户号</span></span></p></td><td><p><span><span>mch_id</span></span></p></td><td><p><span><span>是</span></span></p></td><td><p><span><span>String(32)</span></span></p></td><td><p><span><span>1900000109</span></span></p></td><td><p><span><span>微信支付分配的商户号</span></span></p></td></tr><tr><td><p><span><span>随机字符串</span></span></p></td><td><p><span><span>nonce_str</span></span></p></td><td><p><span><span>是</span></span></p></td><td><p><span><span>String(32)</span></span></p></td><td><p><span><span>5K8264ILTKCH16CQ2502SI8ZNMTM67VS</span></span></p></td><td><p><span><span>随机字符串，不长于32位。推荐随机数生成算法</span></span></p></td></tr><tr><td><p><span><span>加密信息</span></span></p></td><td><p><span><span>req_info</span></span></p></td><td><p><span><span>是</span></span></p></td><td><p><span><span>String(1024)</span></span></p></td><td><p><span><span>T87GAHG17TGAHG1TGHAHAHA1Y1CIOA9UGJH1GAHV871HAGAGQYQQPOOJMXNBCXBVNMNMAJAA</span></span></p></td><td><p><span><span>加密信息请用商户密钥进行解密，详见</span></span><span><span><a>解密方式</a></span></span></p></td></tr></tbody></table></div><div><p><span><span>以下为返回的加密字段：</span></span></p></div><div><table><colgroup><col><col><col><col><col><col></colgroup><tbody><tr><th><p><span><span>字段名</span></span></p></th><th><p><span><span>变量名</span></span></p></th><th><p><span><span>必填</span></span></p></th><th><p><span><span>类型</span></span></p></th><th><p><span><span>示例值</span></span></p></th><th><p><span><span>描述</span></span></p></th></tr><tr><td><p><span><span>微信订单号</span></span></p></td><td><p><span><span>transaction_id</span></span></p></td><td><p><span><span>是</span></span></p></td><td><p><span><span>String(32)</span></span></p></td><td><p><span><span>1217752501201407033233368018</span></span></p></td><td><p><span><span>微信订单号</span></span></p></td></tr><tr><td><p><span><span>商户订单号</span></span></p></td><td><p><span><span>out_trade_no</span></span></p></td><td><p><span><span>是</span></span></p></td><td><p><span><span>String(32)</span></span></p></td><td><p><span><span>1217752501201407033233368018</span></span></p></td><td><p><span><span>商户系统内部的订单号</span></span></p></td></tr><tr><td><p><span><span>微信退款单号</span></span></p></td><td><p><span><span>refund_id</span></span></p></td><td><p><span><span>是</span></span></p></td><td><p><span><span>String(32)</span></span></p></td><td><p><span><span>1217752501201407033233368018</span></span></p></td><td><p><span><span>微信退款单号</span></span></p></td></tr><tr><td><p><span><span>商户退款单号</span></span></p></td><td><p><span><span>out_refund_no</span></span></p></td><td><p><span><span>是</span></span></p></td><td><p><span><span>String(64)</span></span></p></td><td><p><span><span>1217752501201407033233368018</span></span></p></td><td><p><span><span>商户退款单号</span></span></p></td></tr><tr><td><p><span><span>订单金额</span></span></p></td><td><p><span><span>total_fee</span></span></p></td><td><p><span><span>是</span></span></p></td><td><p><span><span>int</span></span></p></td><td><p><span><span>100</span></span></p></td><td><p><span><span>订单总金额，单位为分，只能为整数，</span></span><span><span><a>详见支付金额</a></span></span></p></td></tr><tr><td><p><span><span>应结订单金额</span></span></p></td><td><p><span><span>settlement_total_fee</span></span></p></td><td><p><span><span>否</span></span></p></td><td><p><span><span>int</span></span></p></td><td><p><span><span>100</span></span></p></td><td><p><span><span>当该订单有使用非充值券时，返回此字段。应结订单金额=订单金额-非充值代金券金额，应结订单金额&lt;=订单金额。</span></span></p></td></tr><tr><td><p><span><span>申请退款金额</span></span></p></td><td><p><span><span>refund_fee</span></span></p></td><td><p><span><span>是</span></span></p></td><td><p><span><span>int</span></span></p></td><td><p><span><span>100</span></span></p></td><td><p><span><span>退款总金额,单位为分</span></span></p></td></tr><tr><td><p><span><span>退款金额</span></span></p></td><td><p><span><span>settlement_refund_fee</span></span></p></td><td><p><span><span>是</span></span></p></td><td><p><span><span>int</span></span></p></td><td><p><span><span>100</span></span></p></td><td><p><span><span>退款金额=申请退款金额-非充值代金券退款金额，退款金额&lt;=申请退款金额</span></span></p></td></tr><tr><td><p><span><span>退款状态</span></span></p></td><td><p><span><span>refund_status</span></span></p></td><td><p><span><span>是</span></span></p></td><td><p><span><span>String(16)</span></span></p></td><td><p><span><span>SUCCESS</span></span></p></td><td><p><span><span>SUCCESS-退款成功</span></span><br><span><span>CHANGE-退款异常</span></span><br><span><span>REFUNDCLOSE—退款关闭</span></span></p></td></tr><tr><td><p><span><span>退款成功时间</span></span></p></td><td><p><span><span>success_time</span></span></p></td><td><p><span><span>否</span></span></p></td><td><p><span><span>String(20)</span></span></p></td><td><p><span><span>2017-12-15&nbsp;09:46:01</span></span></p></td><td><p><span><span>资金退款至用户账号的时间，格式2017-12-15&nbsp;09:46:01</span></span></p></td></tr><tr><td><p><span><span>退款入账账户</span></span></p></td><td><p><span><span>refund_recv_accout</span></span></p></td><td><p><span><span>是</span></span></p></td><td><p><span><span>String(64)</span></span></p></td><td><p><span><span>招商银行信用卡0403</span></span></p></td><td><p><span><span>取当前退款单的退款入账方</span></span></p><p><span><span>1）退回银行卡：{银行名称}{卡类型}{卡尾号}</span></span></p><p><span><span>2）退回支付用户零钱:支付用户零钱</span></span></p><p><span><span>3）退还商户:商户基本账户、商户结算银行账户</span></span></p><p><span><span>4）退回支付用户零钱通:支付用户零钱通</span></span></p><p><span><span>5）退回用户经营账户：用户经营账户</span></span></p><p><span><span>6）退回支付用户银行电子账户：支付用户银行电子账户</span></span></p><p><span><span>7）退回支付用户零花钱：支付用户零花钱</span></span></p><p><span><span>8）退回支付用户来华零钱包：支付用户来华零钱包</span></span></p><p><span><span>9）退回企业支付商户：企业支付商户</span></span></p><p><span><span>10）退回支付用户小金罐：支付用户小金罐</span></span></p></td></tr><tr><td><p><span><span>退款资金来源</span></span></p></td><td><p><span><span>refund_account</span></span></p></td><td><p><span><span>是</span></span></p></td><td><p><span><span>String(30)</span></span></p></td><td><p><span><span>REFUND_SOURCE_RECHARGE_FUNDS</span></span></p></td><td><p><span><span>REFUND_SOURCE_RECHARGE_FUNDS&nbsp;可用余额退款/基本账户</span></span><br><span><span>REFUND_SOURCE_UNSETTLED_FUNDS&nbsp;未结算资金退款</span></span></p></td></tr><tr><td><p><span><span>退款发起来源</span></span></p></td><td><p><span><span>refund_request_source</span></span></p></td><td><p><span><span>是</span></span></p></td><td><p><span><span>String(30)</span></span></p></td><td><p><span><span>API</span></span></p></td><td><p><span><span>API接口</span></span><br><span><span>VENDOR_PLATFORM商户平台</span></span></p></td></tr><tr><td><p><span><span>用户退款金额</span></span></p></td><td><p><span><span>cash_refund_fee</span></span></p></td><td><p><span><span>是</span></span></p></td><td><p><span><span>int</span></span></p></td><td><p><span><span>90</span></span></p></td><td><p><span><span>退款给用户的金额，不包含所有优惠券金额</span></span></p></td></tr></tbody></table></div><div><img><pre><span><span>1</span><span><span>举例如下：</span><span>
</span></span></span><span><span>2</span><span><span>&lt;xml&gt;</span><span>
</span></span></span><span><span>3</span><span><span>&nbsp;&nbsp; &lt;return_code&gt;SUCCESS&lt;/return_code&gt;</span><span>
</span></span></span><span><span>4</span><span><span>&nbsp;&nbsp; &lt;appid&gt;&lt;![CDATA[wx8888888888888888]]&gt;&lt;/appid&gt;</span><span>
</span></span></span><span><span>5</span><span><span>&nbsp;&nbsp; &lt;mch_id&gt;&lt;![CDATA[1900000109]]&gt;&lt;/mch_id&gt;</span><span>
</span></span></span><span><span>6</span><span><span>&nbsp;&nbsp; &lt;nonce_str&gt;&lt;![CDATA[5K8264ILTKCH16CQ2502SI8ZNMTM67VS]]&gt;&lt;/nonce_str&gt;</span><span>
</span></span></span><span><span>7</span><span><span>&nbsp;&nbsp; &lt;req_info&gt;&lt;![CDATA[T87GAHG17TGAHG1TGHAHAHA1Y1CIOA9UGJH1GAHV871HAGAGQYQQPOOJMXNBCXBVNMNMAJAA]]&gt;&lt;/req_info&gt;</span><span>
</span></span></span><span><span>8</span><span><span>&nbsp;&nbsp; &lt;return_msg&gt;&lt;![CDATA[90]]&gt;&lt;/return_msg&gt;</span><span>
</span></span></span><span><span>9</span><span><span>&lt;/xml&gt;</span></span></span></pre></div><div><img><pre><span><span>1</span><span><span>req_info解密后的示例：</span><span>
</span></span></span><span><span>2</span><span><span>&lt;root&gt;</span><span>
</span></span></span><span><span>3</span><span><span>&lt;out_refund_no&gt;&lt;![CDATA[131811191610442717309]]&gt;&lt;/out_refund_no&gt;</span><span>
</span></span></span><span><span>4</span><span><span>&lt;out_trade_no&gt;&lt;![CDATA[71106718111915575302817]]&gt;&lt;/out_trade_no&gt;</span><span>
</span></span></span><span><span>5</span><span><span>&lt;refund_account&gt;&lt;![CDATA[REFUND_SOURCE_RECHARGE_FUNDS]]&gt;&lt;/refund_account&gt;</span><span>
</span></span></span><span><span>6</span><span><span>&lt;refund_fee&gt;&lt;![CDATA[3960]]&gt;&lt;/refund_fee&gt;</span><span>
</span></span></span><span><span>7</span><span><span>&lt;refund_id&gt;&lt;![CDATA[50000408942018111907145868882]]&gt;&lt;/refund_id&gt;</span><span>
</span></span></span><span><span>8</span><span><span>&lt;refund_recv_accout&gt;&lt;![CDATA[支付用户零钱]]&gt;&lt;/refund_recv_accout&gt;</span><span>
</span></span></span><span><span>9</span><span><span>&lt;refund_request_source&gt;&lt;![CDATA[API]]&gt;&lt;/refund_request_source&gt;</span><span>
</span></span></span><span><span>10</span><span><span>&lt;refund_status&gt;&lt;![CDATA[SUCCESS]]&gt;&lt;/refund_status&gt;</span><span>
</span></span></span><span><span>11</span><span><span>&lt;settlement_refund_fee&gt;&lt;![CDATA[3960]]&gt;&lt;/settlement_refund_fee&gt;</span><span>
</span></span></span><span><span>12</span><span><span>&lt;settlement_total_fee&gt;&lt;![CDATA[3960]]&gt;&lt;/settlement_total_fee&gt;</span><span>
</span></span></span><span><span>13</span><span><span>&lt;success_time&gt;&lt;![CDATA[2018-11-19&nbsp;16:24:13]]&gt;&lt;/success_time&gt;</span><span>
</span></span></span><span><span>14</span><span><span>&lt;total_fee&gt;&lt;![CDATA[3960]]&gt;&lt;/total_fee&gt;</span><span>
</span></span></span><span><span>15</span><span><span>&lt;transaction_id&gt;&lt;![CDATA[4200000215201811190261405420]]&gt;&lt;/transaction_id&gt;</span><span>
</span></span></span><span><span>16</span><span><span>&lt;cash_refund_fee&gt;&lt;![CDATA[90]]&gt;&lt;/cash_refund_fee&gt;</span><span>
</span></span></span><span><span>17</span><span><span>&lt;/root&gt;</span></span></span></pre></div><div><h2>返回参数</h2></div><div><p><span>商户处理退款通知参数后同步返回给微信参数：</span></p></div><div><table><colgroup><col><col><col><col><col><col></colgroup><tbody><tr><th><p><span>字段名</span></p></th><th><p><span>变量名</span></p></th><th><p><span>必填</span></p></th><th><p><span>类型</span></p></th><th><p><span>示例值</span></p></th><th><p><span>描述</span></p></th></tr><tr><td><p><span>返回状态码</span></p></td><td><p><span>return_code</span></p></td><td><p><span>是</span></p></td><td><p><span>String(16)</span></p></td><td><p><span>SUCCESS</span></p></td><td><p><span>SUCCESS/FAIL</span></p></td></tr><tr><td><p><span>SUCCESS表示商户接收通知成功并校验成功</span></p></td></tr><tr><td><p><span>返回信息</span></p></td><td><p><span>return_msg</span></p></td><td><p><span>否</span></p></td><td><p><span>String(128)</span></p></td><td><p><span>OK</span></p></td><td><p><span>返回信息，如非空，为错误原因</span></p></td></tr><tr><td><p><span>参数格式校验错误</span></p></td></tr></tbody></table></div><div><p><span>举例如下：</span></p></div><div><img><pre><span><span>1</span><span><span>&lt;xml&gt;</span><span>
</span></span></span><span><span>2</span><span><span>&nbsp;&nbsp;&lt;return_code&gt;&lt;![CDATA[SUCCESS]]&gt;&lt;/return_code&gt;</span><span>
</span></span></span><span><span>3</span><span><span>&nbsp;&nbsp;&lt;return_msg&gt;&lt;![CDATA[OK]]&gt;&lt;/return_msg&gt;</span><span>
</span></span></span><span><span>4</span><span><span>&lt;/xml&gt;</span></span></span></pre></div><p>&nbsp;</p></div><p>&nbsp;</p></div></body></html></div><div></div></div><div><div><div> 文档是否有帮助 </div><div><button><i></i>是 </button><button><i></i>否 </button></div></div></div><div><div><div> 更多支持 </div><div><a>开发文档(服务商)</a><a>开发文档(V2版)</a><a>开发者社区</a><a>微信开放平台</a><a>微信公众平台</a><a>腾讯客服</a></div></div></div></div><div><div><div><div><div> 文档是否有帮助 </div><div><button><i></i>是 </button><button><i></i>否 </button></div></div></div><div><div><a><span>应用场景</span></a></div><div><a><span>解密方式</span></a></div><div><a><span>接口链接</span></a></div><div><a><span>通知参数</span></a></div><div><a><span>返回参数</span></a></div></div><div><a><i></i><span>AI开发助手</span></a></div></div><div><div><div><img><img><div> 元宝AI </div></div><div><div><img><img><div> 反馈 </div></div><div><img><img><div> 目录 </div></div><div><img><img><div> 置顶 </div></div></div></div></div></div></div></main><footer><div> Powered By Tencent &amp; Tenpay Copyright 2005-2025 Tenpay All Rights Reserved. </div><div> Powered By Tencent &amp; Tenpay<br>Copyright 2005-2025 Tenpay All Rights Reserved. </div></footer></div></main></section></section></div>
        <div></div>
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
      </body>
    </html>