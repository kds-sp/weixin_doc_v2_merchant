<!DOCTYPE html>
    <html lang="zh-CN">
      <head>
        
        
        
        
        
        
        
        
        
        
        
        
        
        <meta charset="UTF-8" />
        
    <title>HTTPS服务器配置_通用规则|微信支付商户文档中心</title><meta property="og:title" content="HTTPS服务器配置_通用规则|微信支付商户文档中心">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    
    
    
    
  
      </head>
      <body>
        
        <div id="app"><section class="t-layout" data-v-45cd89fe><header class="t-layout__header wrap" data-v-45cd89fe data-v-24ca267f><div class="header" data-v-24ca267f><div class="header-wrap" data-v-24ca267f><div class="logo" data-v-24ca267f><a href="https://pay.weixin.qq.com/" data-v-24ca267f><img class="logo-partner" src="https://wx.gtimg.com/pay/img/common/logo.svg?v=20190327" alt data-v-24ca267f></a></div><div class="link" data-v-24ca267f><a href="https://pay.weixin.qq.com/index.php/core/home/login?return_url=%2F" class="" data-v-24ca267f>首页</a><a href="https://pay.weixin.qq.com/static/applyment_guide/applyment_index.shtml" class="" data-v-24ca267f>接入指引</a><a href="https://pay.weixin.qq.com/static/product/product_index.shtml" class="" data-v-24ca267f>产品中心</a><a href="https://pay.weixin.qq.com/static/solution/solution_index.shtml" class="" data-v-24ca267f>解决方案</a><a href="https://pay.weixin.qq.com/doc/v2" class="selected" data-v-24ca267f>文档中心</a><a href="http://pay.weixin.qq.com/index.php/apply/applyment_home/guide_normal" class="btn-primary btn-apply" target="_blank" data-v-24ca267f>接入微信支付</a></div><div class="navbar-toggle" data-v-24ca267f><div class="navbar-toggle__des" data-v-24ca267f> 文档中心 </div><img class="navbar-toggle__icon" src="https://gtimg.wechatpay.cn/resource/xres/img/202409/55b0d9d534b0ccd145bcbe8e932f3053_80x80.svg" alt data-v-24ca267f></div></div></div><div class="navbar-collapse" data-v-24ca267f><img class="close-icon" src="https://gtimg.wechatpay.cn/resource/xres/img/202409/cbbd950ece1f5688079a7f55da0798f9_48x48.svg" alt data-v-24ca267f><div class="link" data-v-24ca267f><a href="https://pay.weixin.qq.com/index.php/core/home/login?return_url=%2F" class="" data-v-24ca267f>首页</a><a href="https://pay.weixin.qq.com/static/applyment_guide/applyment_index.shtml" class="" data-v-24ca267f>接入指引</a><a href="https://pay.weixin.qq.com/static/product/product_index.shtml" class="" data-v-24ca267f>产品中心</a><a href="https://pay.weixin.qq.com/static/solution/solution_index.shtml" class="" data-v-24ca267f>解决方案</a><a href="https://pay.weixin.qq.com/doc/v2" class="selected" data-v-24ca267f>文档中心</a><a href="https://pay.weixin.qq.com/index.php/apply/applyment_home/guide_normal" class="btn-primary btn-apply" target="_blank" data-v-24ca267f>接入微信支付</a></div></div></header><section class="t-layout subnavbar-layout" data-v-45cd89fe><div class="sub-navbar" data-v-204f5510><div class="sub-navbar-wrap" data-v-204f5510><div class="segment-nav" data-v-204f5510><div class="segment-nav-left" data-v-204f5510><a href="javascript:" class="" data-v-204f5510>产品文档（V2）</a><a href="javascript:" class="selected" data-v-204f5510>通用规则</a><a href="javascript:" class="" data-v-204f5510>SDK&amp;开发工具</a><a href="javascript:" class="" data-v-204f5510>更新日志</a></div></div><div class="segment-nav-box" data-v-204f5510><div class="segment-nav-toggle" data-v-204f5510><div class="sub-navbar-toggle" data-v-204f5510><img class="sub-navbar-toggle__icon" src="https://gtimg.wechatpay.cn/resource/xres/img/202409/6926a37e3d500f8a9446546bb16252ad_80x80.svg" alt="" data-v-204f5510><div class="sub-navbar-toggle__des" data-v-204f5510>通用规则</div></div></div><div class="online-service" data-v-204f5510><button class="t-button t-button--variant-base t-button--theme-primary" type="button" href tabindex="0" data-v-204f5510><span class="t-button__text"> 技术咨询 </span></button></div></div></div></div></section><section class="t-layout content-layout" data-v-45cd89fe><aside class="t-layout__sider wrap" id="sidebar" data-v-45cd89fe data-v-c3fa0a07><div class="sidebar" data-v-c3fa0a07><div class="inner" data-v-c3fa0a07><ul class="sidebar-links sidebar-links-spacing" data-v-c3fa0a07><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading ellipsis"><span><span>接入规范</span></span><span class="up arrow"></span></p><ul class="sidebar-links sidebar-group-items"><li><div><a href="4011939746.html" class="sidebar-link ellipsis"><span>商户收银台H5大字号规范</span></a></div></li><li><div><a href="4011939778.html" class="sidebar-link ellipsis"><span>微信支付二维码规范</span></a></div></li></ul></section></li><li><div><a href="4011985891.html" class="font sidebar-link ellipsis"><span>安全规范</span></a></div></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading ellipsis"><span><span>名词表</span></span><span class="up arrow"></span></p><ul class="sidebar-links sidebar-group-items"><li><div><a href="4011939826.html" class="sidebar-link ellipsis"><span>支付模式</span></a></div></li><li><div><a href="4011939975.html" class="sidebar-link ellipsis"><span>名词解释</span></a></div></li><li><div><a href="4011941162.html" class="sidebar-link ellipsis"><span>参数规定</span></a></div></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="open sidebar-heading ellipsis"><span><span>API安全</span></span><span class="up arrow"></span></p><ul class="sidebar-links sidebar-group-items"><li><div><a href="4011941549.html" class="sidebar-link ellipsis"><span>最佳安全实践</span></a></div></li><li><div><a href="4011984638.html" class="sidebar-link ellipsis"><span>安全与网络相关注意事项</span></a></div></li><li><div><a href="4012197402.html" class="active sidebar-link ellipsis"><span>HTTPS服务器配置</span></a></div></li><li></li><li></li><li></li><li></li><li></li><li></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading ellipsis"><span><span>最佳实践</span></span><span class="up arrow"></span></p><ul class="sidebar-links sidebar-group-items"><li><div><a href="4011984682.html" class="sidebar-link ellipsis"><span>支付回调和查单实现指引</span></a></div></li><li><div><a href="4011984721.html" class="sidebar-link ellipsis"><span>回调通知注意事项</span></a></div></li><li><div><a href="4011984794.html" class="sidebar-link ellipsis"><span>专线商户Notify升级指引</span></a></div></li><li><div><a href="4011984810.html" class="sidebar-link ellipsis"><span>支付验收指引</span></a></div></li><li><div><a href="4011984887.html" class="sidebar-link ellipsis"><span>跨城冗灾方案</span></a></div></li><li></li></ul></section></li></ul></div></div></aside><main class="t-layout__content" data-v-45cd89fe><div class="page-container" data-v-45cd89fe><main class="page" data-v-45cd89fe><div class="page-inner-container" data-v-45cd89fe><div id="page-content" class="page-content" data-v-45cd89fe><h1 class="content-title" data-v-45cd89fe>HTTPS服务器配置</h1><span class="last-updated-date" data-v-45cd89fe> 更新时间：2025.03.04</span><div id="main-content" class="theme-default-content" data-v-45cd89fe><div data-v-45cd89fe><html><head></head><body><div class="iwiki-wrapper"><div class="iwiki-wrapper"><div><h2 class="iwiki-h2" id="一、SSL证书申请"><span><span>一、SSL证书申请</span></span></h2></div><div><p class="iwiki-p"><span><span>1、确认需要申请证书的域名</span></span></p></div><div><p class="iwiki-p"><span><span>2、生成私钥和csr文件</span></span></p></div><div><p class="iwiki-p"><span><span>在linux机器上执行以下命令生成私钥</span></span></p></div><div><p class="iwiki-p"><span><span>#openssl genrsa -out </span></span><span><span><span><span>server.key</span></span></span></span><span><span> 2048</span></span></p></div><div><p class="iwiki-p"><span><span>在linux机器上执行以下命令生成csr文件</span></span></p></div><div><p class="iwiki-p"><span><span>#openssl req -new -key </span></span><span><span><span><span>server.key</span></span></span></span><span><span> -out </span></span><span><span><span><span>certreq.csr</span></span></span></span></p></div><div><p class="iwiki-p"><span><span><span><span>以下黑色标识文字仅供参考，请根据商户自己实际情况进行填写</span></span></span></span></p></div><div><p class="iwiki-p"><span><span>Country Name： </span></span><span><span><span>CN</span></span></span><span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; //您所在国家的ISO标准代号，中国为CN</span></span></p></div><div><p class="iwiki-p"><span><span>State or Province Name：</span></span><span><span><span>guangdong</span></span></span><span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; //您单位所在地省/自治区/直辖市</span></span></p></div><div><p class="iwiki-p"><span><span>Locality Name：</span></span><span><span><span>shenzhen</span></span></span><span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; //您单位所在地的市/县/区</span></span></p></div><div><p class="iwiki-p"><span><span>Organization Name： </span></span><span><span><span>Tencent Technology (Shenzhen) Company Limited</span></span></span><span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; //您单位/机构/企业合法的名称&nbsp;</span></span></p></div><div><p class="iwiki-p"><span><span>Organizational Unit Name： </span></span><span><span><span>R&amp;D</span></span></span><span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; //部门名称&nbsp;</span></span></p></div><div><p class="iwiki-p"><span><span>Common Name： </span></span><span><span><span>www.example.com</span></span></span><span><span>&nbsp;&nbsp;&nbsp;&nbsp; //通用名，例如：www.itrus.com.cn。此项必须与您访问提供SSL服务的服务器时所应用的域名完全匹配。</span></span></p></div><div><p class="iwiki-p"><span><span>Email Address：&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; //您的邮件地址，不必输入，直接回车跳过</span></span></p></div><div><p class="iwiki-p"><span><span>"extra"attributes&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; //以下信息不必输入，回车跳过直到命令执行完毕。</span></span></p></div><div><p class="iwiki-p"><span><span>执行上面的命令后，在当前目录下即可生成私钥文件</span></span><span><span><span><span>server.key</span></span></span></span><span><span>和</span></span><span><span><span><span>certreq.csr </span></span></span></span><span><span><span>c</span></span></span><span><span>sr文件</span></span></p></div><div><p class="iwiki-p"><span><span>3、将生成的csr文件提交给第三方证书颁发机构申请对应域名的服务器证书，同时将私钥文件保存好，以免丢失。</span></span></p></div><div><p class="iwiki-p"><span><span>4、证书申请后，证书颁发机构会提供服务器证书内容和两张中级CA证书，请按证书颁发机器说明生成服务器证书，此处假设服务器证书文件名称为</span></span><span><span><span><span>server.pem</span></span></span></span></p></div><div><p class="iwiki-p"><span><span>5、将生成的私钥文件</span></span><span><span><span><span>server.key</span></span></span></span><span><span>和服务器证书</span></span><span><span><span><span>server.pem</span></span></span></span><span><span>拷贝至服务器指定的目录即可进行HTTPS服务器配置</span></span></p></div><div><h2 class="iwiki-h2" id="二、HTTPS服务器配置"><span>二、HTTPS服务器配置</span></h2></div><div><p class="iwiki-p"><span><span>1、 Nginx配置</span></span></p></div><div><p class="iwiki-p"><span><span>server {</span></span></p></div><div><p class="iwiki-p"><span><span><span>listen&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 443;&nbsp;&nbsp; #指定ssl监听端口</span></span></span></p></div><div><p class="iwiki-p"><span><span><span>server_name&nbsp; www.example.com;</span></span></span></p></div><div><p class="iwiki-p"><span><span><span>ssl on;&nbsp;&nbsp;&nbsp; #开启ssl支持</span></span></span></p></div><div><p class="iwiki-p"><span><span><span>ssl_certificate&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; /etc/nginx/</span></span></span><span><span><span><span>server.pem</span></span></span></span><span><span><span>;&nbsp;&nbsp;&nbsp; #指定服务器证书路径</span></span></span></p></div><div><p class="iwiki-p"><span><span><span>ssl_certificate_key&nbsp; /etc/nginx/</span></span></span><span><span><span><span>server.key</span></span></span></span><span><span><span>;&nbsp;&nbsp;&nbsp; #指定私钥证书路径</span></span></span></p></div><div><p class="iwiki-p"><span><span><span>ssl_session_timeout&nbsp; 5m;</span></span></span></p></div><div><p class="iwiki-p"><span><span><span>ssl_protocols TLSv1 TLSv1.1 TLSv1.2;&nbsp;&nbsp;&nbsp;&nbsp; #指定SSL服务器端支持的协议版本</span></span></span></p></div><div><p class="iwiki-p"><span><span><span>ssl_ciphers&nbsp; ALL：!ADH：!EXPORT56：RC4+RSA：+HIGH：+MEDIUM：+LOW：+SSLv2：+EXP;&nbsp;&nbsp;&nbsp; #指定加密算法</span></span></span></p></div><div><p class="iwiki-p"><span><span><span>ssl_prefer_server_ciphers&nbsp;&nbsp; on;&nbsp;&nbsp;&nbsp; #在使用SSLv3和TLS协议时指定服务器的加密算法要优先于客户端的加密算法</span></span></span></p></div><div><p class="iwiki-p"><span><span>#以下内容请按域名需要进行配置，此处仅供参考</span></span></p></div><div><p class="iwiki-p"><span><span>location / {</span></span></p></div><div><p class="iwiki-p"><span><span>return 444;</span></span></p></div><div><p class="iwiki-p"><span><span>}</span></span></p></div><div><p class="iwiki-p"><span><span>}</span></span></p></div><div><h2 class="iwiki-h2" id="三、相关事项"><span>三、相关事项</span></h2></div><div><p class="iwiki-p"><span><span>1、证书颁发机构</span></span></p></div><div><p class="iwiki-p"><span><span>推荐天威诚信，具体请见：</span></span><span><span><a href="http://www.itrus.com.cn/" target="_blank">http://www.itrus.com.cn</a></span></span></p></div><div><p class="iwiki-p"><span><span>2、 参考文档</span></span></p></div><div><p class="iwiki-p"><span><span><a href="http://nginx.org/en/docs/http/ngx_http_ssl_module.html#ssl_prefer_server_ciphers" target="_blank">《ngx_http_ssl_module》</a></span></span></p></div><div><p class="iwiki-p"><span><span>3、常见问题</span></span></p></div><div><p class="iwiki-p"><span><span>（1）证书受信任的问题</span></span></p></div><div><p class="iwiki-p"><span><span>部分国内签发的SSL证书，在Android上不受信任，推荐GeoTrust；</span></span></p></div><div><p class="iwiki-p"><span><span>（2）如果页面有动静分离，静态资源使用独立域名的话，也需要为该域名申请证书；</span></span></p></div><div><p class="iwiki-p"><span><span>（3）android低版本不支持SNI扩展，受此限制，一台服务器只能部署一个数字证书；</span></span></p></div></div><p class="iwiki-p">&nbsp;</p></div></body></html></div><div class="hr-line" data-v-45cd89fe></div></div><div class="feedback-and-moresupport" data-v-45cd89fe><div class="feedback-box" data-v-45cd89fe data-v-77eca616><div class="feedback-panel-text" data-v-77eca616> 文档是否有帮助 </div><div class="feedback-panel-choices" data-v-77eca616><button class="feedback-option" data-v-77eca616><i class="icon help-icon" data-v-77eca616></i>是 </button><button class="feedback-option" data-v-77eca616><i class="icon no-help-icon" data-v-77eca616></i>否 </button></div></div></div><div class="relative-doc-and-moresupport" data-v-45cd89fe><div class="more-support" data-v-45cd89fe data-v-e0c53a30><div class="more-support__title" data-v-e0c53a30> 更多支持 </div><div class="more-support__lists" data-v-e0c53a30><a href="https://pay.weixin.qq.com/doc/v3/partner/4012069852" target="_blank" data-v-e0c53a30>开发文档(服务商)</a><a href="https://pay.weixin.qq.com/doc/v2" target="_blank" data-v-e0c53a30>开发文档(V2版)</a><a href="https://developers.weixin.qq.com/community/pay" target="_blank" data-v-e0c53a30>开发者社区</a><a href="https://open.weixin.qq.com/" target="_blank" data-v-e0c53a30>微信开放平台</a><a href="https://mp.weixin.qq.com/" target="_blank" data-v-e0c53a30>微信公众平台</a><a href="https://kf.qq.com/product/wechatpaymentmerchant.html" target="_blank" data-v-e0c53a30>腾讯客服</a></div></div></div></div><div class="sub-sidebar" data-v-45cd89fe data-v-7f9bf920><div class="toc" data-v-7f9bf920><div class="mb32" data-v-7f9bf920><div class="feedback-box" data-v-7f9bf920 data-v-77eca616><div class="feedback-panel-text" data-v-77eca616> 文档是否有帮助 </div><div class="feedback-panel-choices" data-v-77eca616><button class="feedback-option" data-v-77eca616><i class="icon help-icon" data-v-77eca616></i>是 </button><button class="feedback-option" data-v-77eca616><i class="icon no-help-icon" data-v-77eca616></i>否 </button></div></div></div><div class="toc-container mb40" data-v-7f9bf920 data-v-c65b4426><div class="toc-h2 toc-active toc-item" data-v-c65b4426><a href="4012197402.html#一、SSL证书申请" title="一、SSL证书申请" class="ellipsis" data-v-c65b4426><span data-v-c65b4426>一、SSL证书申请</span></a></div><div class="toc-h2 toc-item" data-v-c65b4426><a href="4012197402.html#二、HTTPS服务器配置" title="二、HTTPS服务器配置" class="ellipsis" data-v-c65b4426><span data-v-c65b4426>二、HTTPS服务器配置</span></a></div><div class="toc-h2 toc-item" data-v-c65b4426><a href="4012197402.html#三、相关事项" title="三、相关事项" class="ellipsis" data-v-c65b4426><span data-v-c65b4426>三、相关事项</span></a></div></div><div class="support-container" data-v-7f9bf920 data-v-787fd1f1><a href="https://support.pay.weixin.qq.com/aidevhelper?from=wechatpaydoc" target="_blank" class="support-btn" data-v-787fd1f1><i class="support-icon" data-v-787fd1f1></i><span class="support-text" data-v-787fd1f1>AI开发助手</span></a></div></div><div class="toc-mobile" data-v-7f9bf920><div class="sub-sidebar-group" data-v-7f9bf920 data-v-08ae15f6><div class="group-item" data-v-08ae15f6><img class="group-icon" src="https://gtimg.wechatpay.cn/resource/xres/img/202509/441b156fa07f0548ddda2a0b711b478e_20x20.svg" alt="" data-v-08ae15f6><img class="group-icon-hover" src="https://gtimg.wechatpay.cn/resource/xres/img/202509/441b156fa07f0548ddda2a0b711b478e_20x20.svg" alt="" data-v-08ae15f6><div class="group-info" data-v-08ae15f6> 元宝AI </div></div><div class="group-items" data-v-08ae15f6><div class="group-item" data-v-08ae15f6><img class="group-icon" src="https://gtimg.wechatpay.cn/resource/xres/img/202409/5c7b6ed2432ae0401a49a60329a1c5c9_80x80.svg" alt="" data-v-08ae15f6><img class="group-icon-hover" src="https://gtimg.wechatpay.cn/resource/xres/img/202409/c2c45e34bb7e9c67c51b22550d44b813_80x80.svg" alt="" data-v-08ae15f6><div class="group-info" data-v-08ae15f6> 反馈 </div></div><div class="group-item" data-v-08ae15f6><img class="group-icon" src="https://gtimg.wechatpay.cn/resource/xres/img/202409/55b0d9d534b0ccd145bcbe8e932f3053_80x80.svg" alt="" data-v-08ae15f6><img class="group-icon-hover" src="https://gtimg.wechatpay.cn/resource/xres/img/202409/88d0ba6a5d2578733aa9f3c586f07224_80x80.svg" alt="" data-v-08ae15f6><div class="group-info" data-v-08ae15f6> 目录 </div></div><div class="group-item" data-v-08ae15f6><img class="group-icon" src="https://gtimg.wechatpay.cn/resource/xres/img/202409/70ba1309ab6ade7e84f4f6d006c15621_48x49.png" alt="" data-v-08ae15f6><img class="group-icon-hover" src="https://gtimg.wechatpay.cn/resource/xres/img/202409/eb04b4d41529b9413c0cba2a825c9d95_48x49.png" alt="" data-v-08ae15f6><div class="group-info" data-v-08ae15f6> 置顶 </div></div></div></div></div></div></div></main><footer class="t-layout__footer footer" data-v-45cd89fe><div class="footer-copyright" data-v-45cd89fe> Powered By Tencent &amp; Tenpay Copyright 2005-2025 Tenpay All Rights Reserved. </div><div class="footer-copyright footer-copyright-mobile" data-v-45cd89fe> Powered By Tencent &amp; Tenpay<br data-v-45cd89fe>Copyright 2005-2025 Tenpay All Rights Reserved. </div></footer></div></main></section></section></div>
        <div id="teleported"></div>
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
      </body>
    </html>