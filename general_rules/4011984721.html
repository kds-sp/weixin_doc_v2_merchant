<!DOCTYPE html>
    <html lang="zh-CN">
      <head>
        
        
        
        
        
        
        
        
        
        
        
        
        
        <meta charset="UTF-8" />
        
    <title>回调通知注意事项_通用规则|微信支付商户文档中心</title><meta property="og:title" content="回调通知注意事项_通用规则|微信支付商户文档中心">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <!--[--><!--]-->
    
    
    
  
      </head>
      <body>
        
        <div id="app"><!--[--><section class="t-layout" data-v-45cd89fe><!--[--><header class="t-layout__header wrap" data-v-45cd89fe data-v-24ca267f><!--[--><div class="header" data-v-24ca267f><div class="header-wrap" data-v-24ca267f><div class="logo" data-v-24ca267f><a href="https://pay.weixin.qq.com/" data-v-24ca267f><img class="logo-partner" src="https://wx.gtimg.com/pay/img/common/logo.svg?v=20190327" alt data-v-24ca267f></a></div><div class="link" data-v-24ca267f><!--[--><a href="https://pay.weixin.qq.com/index.php/core/home/login?return_url=%2F" class="" data-v-24ca267f>首页</a><a href="https://pay.weixin.qq.com/static/applyment_guide/applyment_index.shtml" class="" data-v-24ca267f>接入指引</a><a href="https://pay.weixin.qq.com/static/product/product_index.shtml" class="" data-v-24ca267f>产品中心</a><a href="https://pay.weixin.qq.com/static/solution/solution_index.shtml" class="" data-v-24ca267f>解决方案</a><a href="https://pay.weixin.qq.com/doc/v3/merchant/4012062524" class="selected" data-v-24ca267f>文档中心</a><a href="http://pay.weixin.qq.com/index.php/apply/applyment_home/guide_normal" class="btn-primary btn-apply" target="_blank" data-v-24ca267f>接入微信支付</a><!--]--></div><div class="navbar-toggle" data-v-24ca267f><div class="navbar-toggle__des" data-v-24ca267f> 文档中心 </div><img class="navbar-toggle__icon" src="https://gtimg.wechatpay.cn/resource/xres/img/202409/55b0d9d534b0ccd145bcbe8e932f3053_80x80.svg" alt data-v-24ca267f></div></div></div><!----><div class="navbar-collapse" data-v-24ca267f><img class="close-icon" src="https://gtimg.wechatpay.cn/resource/xres/img/202409/cbbd950ece1f5688079a7f55da0798f9_48x48.svg" alt data-v-24ca267f><div class="link" data-v-24ca267f><!--[--><a href="https://pay.weixin.qq.com/index.php/core/home/login?return_url=%2F" class="" data-v-24ca267f>首页</a><a href="https://pay.weixin.qq.com/static/applyment_guide/applyment_index.shtml" class="" data-v-24ca267f>接入指引</a><a href="https://pay.weixin.qq.com/static/product/product_index.shtml" class="" data-v-24ca267f>产品中心</a><a href="https://pay.weixin.qq.com/static/solution/solution_index.shtml" class="" data-v-24ca267f>解决方案</a><a href="https://pay.weixin.qq.com/doc/v3/partner/4012069852" class="selected" data-v-24ca267f>文档中心</a><a href="https://pay.weixin.qq.com/index.php/apply/applyment_home/guide_normal" class="btn-primary btn-apply" target="_blank" data-v-24ca267f>接入微信支付</a><!--]--></div></div><!--]--></header><section class="t-layout subnavbar-layout" data-v-45cd89fe><!--[--><!--[--><div class="sub-navbar" data-v-204f5510><div class="sub-navbar-wrap" data-v-204f5510><div class="segment-nav" data-v-204f5510><div class="segment-nav-left" data-v-204f5510><!--[--><!--[--><a href="javascript:" class="" data-v-204f5510>产品文档（V2）</a><!--]--><!--[--><a href="javascript:" class="selected" data-v-204f5510>通用规则</a><!--]--><!--[--><a href="javascript:" class="" data-v-204f5510>SDK&amp;开发工具</a><!--]--><!--[--><a href="javascript:" class="" data-v-204f5510>更新日志</a><!--]--><!--]--></div><!----></div><div class="segment-nav-box" data-v-204f5510><div class="segment-nav-toggle" data-v-204f5510><div class="sub-navbar-toggle" data-v-204f5510><img class="sub-navbar-toggle__icon" src="https://gtimg.wechatpay.cn/resource/xres/img/202409/6926a37e3d500f8a9446546bb16252ad_80x80.svg" alt="" data-v-204f5510><div class="sub-navbar-toggle__des" data-v-204f5510>通用规则</div></div></div><div class="online-service" data-v-204f5510><button class="t-button t-button--variant-base t-button--theme-primary" type="button" href tabindex="0" data-v-204f5510><span class="t-button__text"><!--[--> 技术咨询 <!--]--></span></button></div><!----><!----><!----><!----></div></div></div><!----><!----><!--]--><!--]--></section><section class="t-layout content-layout" data-v-45cd89fe><!--[--><aside class="t-layout__sider wrap" id="sidebar" data-v-45cd89fe data-v-c3fa0a07><!--[--><div class="sidebar" data-v-c3fa0a07><div class="inner" data-v-c3fa0a07><ul class="sidebar-links sidebar-links-spacing" data-v-c3fa0a07><!--[--><li><!--[--><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading ellipsis"><span><!--[--><span><!--[-->接入规范<!--]--></span><!----><!--]--></span><span class="up arrow"></span></p><ul class="sidebar-links sidebar-group-items"><!--[--><li><!--[--><div><a href="4011939746.html" class="sidebar-link ellipsis"><!--[--><span><!--[-->商户收银台H5大字号规范<!--]--></span><!----><!--]--></a></div><!--]--></li><li><!--[--><div><a href="4011939778.html" class="sidebar-link ellipsis"><!--[--><span><!--[-->微信支付二维码规范<!--]--></span><!----><!--]--></a></div><!--]--></li><!--]--></ul></section><!--]--></li><li><!--[--><div><a href="4011985891.html" class="font sidebar-link ellipsis"><!--[--><span><!--[-->安全规范<!--]--></span><!----><!--]--></a></div><!--]--></li><li><!--[--><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading ellipsis"><span><!--[--><span><!--[-->名词表<!--]--></span><!----><!--]--></span><span class="up arrow"></span></p><ul class="sidebar-links sidebar-group-items"><!--[--><li><!--[--><div><a href="4011939826.html" class="sidebar-link ellipsis"><!--[--><span><!--[-->支付模式<!--]--></span><!----><!--]--></a></div><!--]--></li><li><!--[--><div><a href="4011939975.html" class="sidebar-link ellipsis"><!--[--><span><!--[-->名词解释<!--]--></span><!----><!--]--></a></div><!--]--></li><li><!--[--><div><a href="4011941162.html" class="sidebar-link ellipsis"><!--[--><span><!--[-->参数规定<!--]--></span><!----><!--]--></a></div><!--]--></li><!--]--></ul></section><!--]--></li><li><!--[--><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading ellipsis"><span><!--[--><span><!--[-->API安全<!--]--></span><!----><!--]--></span><span class="up arrow"></span></p><ul class="sidebar-links sidebar-group-items"><!--[--><li><!--[--><div><a href="4011941549.html" class="sidebar-link ellipsis"><!--[--><span><!--[-->最佳安全实践<!--]--></span><!----><!--]--></a></div><!--]--></li><li><!--[--><div><a href="4011984638.html" class="sidebar-link ellipsis"><!--[--><span><!--[-->安全与网络相关注意事项<!--]--></span><!----><!--]--></a></div><!--]--></li><li><!--[--><div><a href="4012197402.html" class="sidebar-link ellipsis"><!--[--><span><!--[-->HTTPS服务器配置<!--]--></span><!----><!--]--></a></div><!--]--></li><li><!----></li><li><!----></li><li><!----></li><li><!----></li><li><!----></li><li><!----></li><!--]--></ul></section><!--]--></li><li><!--[--><section class="sidebar-group collapsable depth-0"><p class="open sidebar-heading ellipsis"><span><!--[--><span><!--[-->最佳实践<!--]--></span><!----><!--]--></span><span class="up arrow"></span></p><ul class="sidebar-links sidebar-group-items"><!--[--><li><!--[--><div><a href="4011984682.html" class="sidebar-link ellipsis"><!--[--><span><!--[-->支付回调和查单实现指引<!--]--></span><!----><!--]--></a></div><!--]--></li><li><!--[--><div><a href="4011984721.html" class="active sidebar-link ellipsis"><!--[--><span><!--[-->回调通知注意事项<!--]--></span><!----><!--]--></a></div><!--]--></li><li><!--[--><div><a href="4011984794.html" class="sidebar-link ellipsis"><!--[--><span><!--[-->专线商户Notify升级指引<!--]--></span><!----><!--]--></a></div><!--]--></li><li><!--[--><div><a href="4011984810.html" class="sidebar-link ellipsis"><!--[--><span><!--[-->支付验收指引<!--]--></span><!----><!--]--></a></div><!--]--></li><li><!--[--><div><a href="4011984887.html" class="sidebar-link ellipsis"><!--[--><span><!--[-->跨城冗灾方案<!--]--></span><!----><!--]--></a></div><!--]--></li><li><!----></li><!--]--></ul></section><!--]--></li><!--]--></ul></div></div><!--]--></aside><main class="t-layout__content" data-v-45cd89fe><!--[--><div class="page-container" data-v-45cd89fe><main class="page" data-v-45cd89fe><div class="page-inner-container" data-v-45cd89fe><div id="page-content" class="page-content" data-v-45cd89fe><h1 class="content-title" data-v-45cd89fe>回调通知注意事项</h1><span class="last-updated-date" data-v-45cd89fe> 更新时间：2024.11.13</span><div id="main-content" class="theme-default-content" data-v-45cd89fe><div data-v-45cd89fe><html><head></head><body><div class="iwiki-wrapper"><div class="iwiki-wrapper"><h2 class="iwiki-h2" id="1、notify_url填写注意事项"><span><span>1、notify_url填写注意事项</span></span></h2><p class="iwiki-p"><span><span><span>● notify_url需要填写商户自己系统的真实地址，不能填写接口文档或demo上的示例地址。</span></span></span><br><span><span><span>● notify_url必须是以https://或http://开头的完整全路径地址，并且确保url中的域名和IP是外网可以访问的，不能填写localhost、127.0.0.1、192.168.x.x等本地或内网IP。</span></span></span><br><span><span><span>● notify_url不能携带参数。</span></span></span><br><span><span><span>● 常见错误举例：</span></span></span></p><div class="iwiki-tableNode-wrapper"><table class="iwiki-tableNode" width="100%"><colgroup><col><col></colgroup><tbody><tr><th colspan="1" rowspan="1" class="iwiki-tableHeader" bgcolor="#f4f5f9" align="left" valign="top"><p class="iwiki-p"><span><span>错误描述</span></span></p></th><th colspan="1" rowspan="1" class="iwiki-tableHeader" bgcolor="#f4f5f9" align="left" valign="top"><p class="iwiki-p"><span><span>错误示例</span></span></p></th></tr><tr><td colspan="1" rowspan="1" class="iwiki-tableCell" bgcolor="white" valign="middle"><p class="iwiki-p"><span><span>url中只有域名，缺少具体的路径</span></span></p></td><td colspan="1" rowspan="1" class="iwiki-tableCell" bgcolor="white" valign="middle"><p class="iwiki-p"><span><span>http://www.weixin.qq.com</span></span></p></td></tr><tr><td colspan="1" rowspan="1" class="iwiki-tableCell" bgcolor="white" valign="middle"><p class="iwiki-p"><span><span>url不是以https://或http://开头，缺少域名或IP</span></span></p></td><td colspan="1" rowspan="1" class="iwiki-tableCell" bgcolor="white" valign="middle"><p class="iwiki-p"><span><span>./PayNotify.aspx</span></span></p></td></tr><tr><td colspan="1" rowspan="1" class="iwiki-tableCell" bgcolor="white" valign="middle"><p class="iwiki-p"><span><span>url中填写了本地或者内网IP</span></span></p></td><td colspan="1" rowspan="1" class="iwiki-tableCell" bgcolor="white" valign="middle"><p class="iwiki-p"><span><span>http://127.0.0.1/pay/notify.php</span></span></p></td></tr><tr><td colspan="1" rowspan="1" class="iwiki-tableCell" bgcolor="white" valign="middle"><p class="iwiki-p"><span><span>填写了不是url格式的字符串</span></span></p></td><td colspan="1" rowspan="1" class="iwiki-tableCell" bgcolor="white" valign="middle"><p class="iwiki-p"><span><span>xxxxxxx，1234567，test</span></span></p></td></tr></tbody></table></div><div><h2 class="iwiki-h2" id="2、返回报文格式规范"><span><span>2、返回报文格式规范</span></span></h2></div><p class="iwiki-p"><span><span>● 返回报文必须是xml格式，字段名需与接口文档说明的一致，报文前后和各字段标签中间不能包含特殊字符。</span></span><br><span><span>● 常见错误举例：</span></span></p><div class="iwiki-tableNode-wrapper"><table class="iwiki-tableNode" width="100%"><colgroup><col><col></colgroup><tbody><tr><th colspan="1" rowspan="1" class="iwiki-tableHeader" bgcolor="#f4f5f9" align="left" valign="top"><p class="iwiki-p"><span><span>错误描述</span></span></p></th><th colspan="1" rowspan="1" class="iwiki-tableHeader" bgcolor="#f4f5f9" align="left" valign="top"><p class="iwiki-p"><span><span>错误示例</span></span></p></th></tr><tr><td colspan="1" rowspan="1" class="iwiki-tableCell" bgcolor="white" valign="middle"><p class="iwiki-p"><span><span>返回内容为空或者非xml格式字符串</span></span></p></td><td colspan="1" rowspan="1" class="iwiki-tableCell" bgcolor="white" valign="middle"><p class="iwiki-p"><span><span>ok，success，支付成功</span></span></p></td></tr><tr><td colspan="1" rowspan="1" class="iwiki-tableCell" bgcolor="white" valign="middle"><p class="iwiki-p"><span><span>返回的xml格式报文中间有其他字符</span></span></p></td><td colspan="1" rowspan="1" class="iwiki-tableCell" bgcolor="white" valign="middle"><p class="iwiki-p"><span><span>&lt;xml&gt;\n&lt;return_code&gt;&lt;![CDATA[SUCCESS]]&gt;&lt;/return_code&gt;</span></span><br><span><span>\n&lt;return_msg&gt;&lt;![CDATA[OK]]&gt;&lt;/return_msg&gt;\n&lt;/xml&gt;</span></span></p></td></tr><tr><td colspan="1" rowspan="1" class="iwiki-tableCell" bgcolor="white" valign="middle"><p class="iwiki-p"><span><span>返回的是json格式</span></span></p></td><td colspan="1" rowspan="1" class="iwiki-tableCell" bgcolor="white" valign="middle"><p class="iwiki-p"><span><span>{"return_code":"SUCCESS";"return_msg":"OK"}</span></span></p></td></tr><tr><td colspan="1" rowspan="1" class="iwiki-tableCell" bgcolor="white" valign="middle"><p class="iwiki-p"><span><span>返回的是整个页面的html代码</span></span></p></td><td colspan="1" rowspan="1" class="iwiki-tableCell" bgcolor="white" valign="middle"><p class="iwiki-p"><span><span>&lt;!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"&gt;&lt;html xmlns="http://www.w3.org/1999/xhtml" &gt;&lt;head&gt;&lt;title&gt;支付成功通知页面&lt;/title&gt;&lt;/head&gt;&lt;body&gt;success&lt;/body&gt;&lt;/html&gt;</span></span></p></td></tr></tbody></table></div><div><h2 class="iwiki-h2" id="3、回调处理逻辑注意事项"><span><span>3、回调处理逻辑注意事项</span></span></h2></div><p class="iwiki-p"><span><span>● notify_url的代码处理逻辑不能做登录态校验。</span></span><br><span><span>● 商户系统收到支付结果通知，需要在5秒内返回应答报文，否则微信支付认为通知失败，后续会重复发送通知。</span></span><br><span><span>● 同样的通知可能会多次发送给商户系统，商户系统必须能够正确处理重复的通知。如果已处理过，直接给微信支付返回成功。</span></span><br><span><span>● 商户侧对微信支付回调IP有防火墙策略限制的，需要对以下IP段开通白名单：</span></span></p><div><p class="iwiki-p"><span><span>上海电信出口网段：101.226.103.0/25</span></span><br><span><span>上海联通出口网段：140.207.54.0/25</span></span><br><span><span>上海CAP出口网段：121.51.58.128/25</span></span><br><span><span>深圳电信出口网段：183.3.234.0/25</span></span><br><span><span>深圳联通出口网段：58.251.80.0/25</span></span><br><span><span>深圳CAP出口网段：121.51.30.128/25</span></span><br><span><span>香港出口网段：203.205.219.128/25</span></span><br><span><span>退款结果通知、分账动账通知IP（新增）：</span></span><br><span><span>175.24.214.208、175.24.211.24、175.24.213.135、109.244.180.23、114.132.203.119、43.139.43.69</span></span></p></div></div><p class="iwiki-p">&nbsp;</p></div></body></html></div><div class="hr-line" data-v-45cd89fe></div></div><div class="feedback-and-moresupport" data-v-45cd89fe><div class="feedback-box" data-v-45cd89fe data-v-77eca616><div class="feedback-panel-text" data-v-77eca616> 文档是否有帮助 </div><!----><div class="feedback-panel-choices" data-v-77eca616><button class="feedback-option" data-v-77eca616><i class="icon help-icon" data-v-77eca616></i>是 </button><button class="feedback-option" data-v-77eca616><i class="icon no-help-icon" data-v-77eca616></i>否 </button></div></div></div><div class="relative-doc-and-moresupport" data-v-45cd89fe><div class="more-support" data-v-45cd89fe data-v-e0c53a30><div class="more-support__title" data-v-e0c53a30> 更多支持 </div><div class="more-support__lists" data-v-e0c53a30><!--[--><a href="https://pay.weixin.qq.com/doc/v3/partner/4012069852" target="_blank" data-v-e0c53a30>开发文档(服务商)</a><a href="https://pay.weixin.qq.com/doc/v2" target="_blank" data-v-e0c53a30>开发文档(V2版)</a><!--]--><a href="https://developers.weixin.qq.com/community/pay" target="_blank" data-v-e0c53a30>开发者社区</a><a href="https://open.weixin.qq.com/" target="_blank" data-v-e0c53a30>微信开放平台</a><a href="https://mp.weixin.qq.com/" target="_blank" data-v-e0c53a30>微信公众平台</a><a href="https://kf.qq.com/product/wechatpaymentmerchant.html" target="_blank" data-v-e0c53a30>腾讯客服</a></div></div></div></div><div class="sub-sidebar" data-v-45cd89fe data-v-7f9bf920><div class="toc" data-v-7f9bf920><div class="mb32" data-v-7f9bf920><div class="feedback-box" data-v-7f9bf920 data-v-77eca616><div class="feedback-panel-text" data-v-77eca616> 文档是否有帮助 </div><!----><div class="feedback-panel-choices" data-v-77eca616><button class="feedback-option" data-v-77eca616><i class="icon help-icon" data-v-77eca616></i>是 </button><button class="feedback-option" data-v-77eca616><i class="icon no-help-icon" data-v-77eca616></i>否 </button></div></div></div><div class="toc-container mb40" data-v-7f9bf920 data-v-c65b4426><!--[--><div class="toc-h2 toc-active toc-item" data-v-c65b4426><a href="4011984721.html#1、notify_url填写注意事项" title="1、notify_url填写注意事项" class="ellipsis" data-v-c65b4426><span data-v-c65b4426>1、notify_url填写注意事项</span></a></div><div class="toc-h2 toc-item" data-v-c65b4426><a href="4011984721.html#2、返回报文格式规范" title="2、返回报文格式规范" class="ellipsis" data-v-c65b4426><span data-v-c65b4426>2、返回报文格式规范</span></a></div><div class="toc-h2 toc-item" data-v-c65b4426><a href="4011984721.html#3、回调处理逻辑注意事项" title="3、回调处理逻辑注意事项" class="ellipsis" data-v-c65b4426><span data-v-c65b4426>3、回调处理逻辑注意事项</span></a></div><!--]--></div><div class="support-container" data-v-7f9bf920 data-v-787fd1f1><a href="https://support.pay.weixin.qq.com/aidevhelper?from=wechatpaydoc" target="_blank" class="support-btn" data-v-787fd1f1><i class="support-icon" data-v-787fd1f1></i><span class="support-text" data-v-787fd1f1>AI开发助手</span></a></div></div><div class="toc-mobile" data-v-7f9bf920><div class="sub-sidebar-group" data-v-7f9bf920 data-v-08ae15f6><div class="group-item" data-v-08ae15f6><img class="group-icon" src="https://gtimg.wechatpay.cn/resource/xres/img/202509/441b156fa07f0548ddda2a0b711b478e_20x20.svg" alt="" data-v-08ae15f6><img class="group-icon-hover" src="https://gtimg.wechatpay.cn/resource/xres/img/202509/441b156fa07f0548ddda2a0b711b478e_20x20.svg" alt="" data-v-08ae15f6><div class="group-info" data-v-08ae15f6> 元宝AI </div></div><div class="group-items" data-v-08ae15f6><div class="group-item" data-v-08ae15f6><img class="group-icon" src="https://gtimg.wechatpay.cn/resource/xres/img/202409/5c7b6ed2432ae0401a49a60329a1c5c9_80x80.svg" alt="" data-v-08ae15f6><img class="group-icon-hover" src="https://gtimg.wechatpay.cn/resource/xres/img/202409/c2c45e34bb7e9c67c51b22550d44b813_80x80.svg" alt="" data-v-08ae15f6><div class="group-info" data-v-08ae15f6> 反馈 </div></div><div class="group-item" data-v-08ae15f6><img class="group-icon" src="https://gtimg.wechatpay.cn/resource/xres/img/202409/55b0d9d534b0ccd145bcbe8e932f3053_80x80.svg" alt="" data-v-08ae15f6><img class="group-icon-hover" src="https://gtimg.wechatpay.cn/resource/xres/img/202409/88d0ba6a5d2578733aa9f3c586f07224_80x80.svg" alt="" data-v-08ae15f6><div class="group-info" data-v-08ae15f6> 目录 </div></div><div class="group-item" data-v-08ae15f6><img class="group-icon" src="https://gtimg.wechatpay.cn/resource/xres/img/202409/70ba1309ab6ade7e84f4f6d006c15621_48x49.png" alt="" data-v-08ae15f6><img class="group-icon-hover" src="https://gtimg.wechatpay.cn/resource/xres/img/202409/eb04b4d41529b9413c0cba2a825c9d95_48x49.png" alt="" data-v-08ae15f6><div class="group-info" data-v-08ae15f6> 置顶 </div></div></div><!----><!----></div></div></div></div><!----></main><footer class="t-layout__footer footer" data-v-45cd89fe><!--[--><div class="footer-copyright" data-v-45cd89fe> Powered By Tencent &amp; Tenpay Copyright 2005-2025 Tenpay All Rights Reserved. </div><div class="footer-copyright footer-copyright-mobile" data-v-45cd89fe> Powered By Tencent &amp; Tenpay<br data-v-45cd89fe>Copyright 2005-2025 Tenpay All Rights Reserved. </div><!--]--></footer></div><!--]--></main><!--]--></section><!--]--></section><!--]--></div>
        <div id="teleported"></div>
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
      </body>
    </html>